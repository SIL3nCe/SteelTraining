file(MAKE_DIRECTORY "${SHINE_EDITOR_EXT_DIR}")

if(WIN32)
	set(SOURCES_DLLMAIN dllmain.cpp)
else(WIN32)
	set(SOURCES_DLLMAIN)
endif(WIN32)

add_library(Extension SHARED Extension.cpp Extension.h ${SOURCES_DLLMAIN} $<TARGET_OBJECTS:Plugin_Editor>)

set_property(TARGET Extension PROPERTY FOLDER "Editor")
set_property(TARGET Extension APPEND PROPERTY COMPILE_DEFINITIONS "${SHSDK_COMPILE_DEFINITIONS}")
set_property(TARGET Extension APPEND PROPERTY COMPILE_FLAGS "${SHSDK_COMPILE_FLAGS}")
set_property(TARGET Extension APPEND PROPERTY COMPILE_DEFINITIONS "SH_EDITOR=1" "_INTERNAL_DLL") # FIXME

target_link_libraries(Extension PRIVATE "${SHSDK_EDITOR_LIBRARIES}")
target_include_directories(Extension PRIVATE "${SHSDK_INCLUDE_DIRS}")

if(WIN32)
	set_property(TARGET Extension PROPERTY RUNTIME_OUTPUT_DIRECTORY "${SHINE_EDITOR_EXT_DIR}")
	set_property(TARGET Extension PROPERTY RUNTIME_OUTPUT_DIRECTORY_DEBUG "${SHINE_EDITOR_EXT_DIR}")
	set_property(TARGET Extension PROPERTY RUNTIME_OUTPUT_DIRECTORY_RELEASE "${SHINE_EDITOR_EXT_DIR}")
else(WIN32)
	set_property(TARGET Extension PROPERTY LIBRARY_OUTPUT_DIRECTORY "${SHINE_EDITOR_EXT_DIR}")
	set_property(TARGET Extension PROPERTY LIBRARY_OUTPUT_DIRECTORY_DEBUG "${SHINE_EDITOR_EXT_DIR}")
	set_property(TARGET Extension PROPERTY LIBRARY_OUTPUT_DIRECTORY_RELEASE "${SHINE_EDITOR_EXT_DIR}")
endif(WIN32)

set_property(TARGET Extension PROPERTY PREFIX )

file(COPY "Extension.configext" DESTINATION "${SHINE_EDITOR_EXT_DIR}")
